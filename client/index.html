<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pokémon Evolution Guessing Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
      body {
          font-family: 'Press Start 2P', cursive;
          background-color: #F6E7D8; /* A soft, playful background color */
      }
      .pokemon-card {
          transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
          border: 4px solid #4A4A4A; /* A border to mimic classic game UI */
          border-radius: 12px;
          background-color: #FFF;
      }
      .pokemon-card:hover {
          transform: translateY(-10px);
          box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      }
      .feedback {
          transition: opacity 0.5s ease-in-out;
      }
      .correct {
          animation: correct-animation 0.5s forwards;
      }
      @keyframes correct-animation {
          0% { background-color: #fff; transform: scale(1); }
          50% { background-color: #A7F3D0; transform: scale(1.05); } /* A light green for correct answers */
          100% { background-color: #fff; transform: scale(1); }
      }
      .wrong {
          animation: wrong-animation 0.5s forwards;
      }
      @keyframes wrong-animation {
          0% { transform: translateX(0); }
          25% { transform: translateX(-10px); }
          50% { transform: translateX(10px); }
          75% { transform: translateX(-10px); }
          100% { transform: translateX(0); background-color: #FECACA; } /* A light red for wrong answers */
      }
      .btn-next {
          background-color: #3B82F6; /* A vibrant blue */
          color: white;
          padding: 10px 20px;
          border-radius: 8px;
          border: 2px solid #2563EB;
          cursor: pointer;
          transition: background-color 0.2s;
      }
      .btn-next:hover {
          background-color: #2563EB;
      }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

<div id="game-container" class="w-full max-w-4xl mx-auto text-center">

  <h1 class="text-3xl md:text-5xl font-bold text-gray-800 mb-2">Who's That Evolution?</h1>
  <p class="text-gray-600 mb-8">Guess the correct evolution!</p>

  <!-- Score and feedback section -->
  <div class="flex justify-between items-center mb-8 px-4">
    <h2 class="text-2xl font-bold text-gray-800">Score: <span id="score">0</span></h2>
    <div id="feedback-message" class="text-2xl font-bold feedback opacity-0"></div>
  </div>

  <!-- Main Pokémon to evolve -->
  <div class="mb-12">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">Evolve this Pokémon!</h2>
    <div id="main-pokemon" class="pokemon-card inline-block p-4 bg-blue-100">
      <!-- You will replace this with the Pokémon image -->
      <div class="pokemon-card-img w-40 h-40 md:w-48 md:h-48 bg-gray-300 flex items-center justify-center rounded-lg">
      </div>
    </div>
  </div>

  <!-- Evolution options -->
  <div>
    <h2 class="text-2xl font-bold text-gray-800 mb-6">Choose the correct evolution:</h2>
    <div id="options-container" class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
      <!-- Option 1 -->
      <div class="pokemon-card p-4 cursor-pointer" onclick="checkAnswer(this)">
        <!-- You will replace this with the Pokémon image -->
        <div class="pokemon-card-img w-40 h-40 md:w-48 md:h-48 bg-gray-300 flex items-center justify-center rounded-lg mx-auto">
        </div>
      </div>
      <!-- Option 2 -->
      <div class="pokemon-card p-4 cursor-pointer" onclick="checkAnswer(this)">
        <!-- You will replace this with the Pokémon image -->
        <div class="pokemon-card-img w-40 h-40 md:w-48 md:h-48 bg-gray-300 flex items-center justify-center rounded-lg mx-auto">
        </div>
      </div>
      <!-- Option 3 -->
      <div class="pokemon-card p-4 cursor-pointer" onclick="checkAnswer(this)">
        <!-- You will replace this with the Pokémon image -->
        <div class="pokemon-card-img w-40 h-40 md:w-48 md:h-48 bg-gray-300 flex items-center justify-center rounded-lg mx-auto">
        </div>
      </div>
    </div>
  </div>

  <!-- Next button -->
  <div id="next-button-container" class="mt-12 text-center" style="display: none;">
    <button class="btn-next" onclick="nextRound()">Next Pokémon</button>
  </div>

</div>

<script>
  let score = 0;
  let gameLocked = false;

  const scoreEl = document.getElementById('score');
  const feedbackEl = document.getElementById('feedback-message');
  const optionsContainer = document.getElementById('options-container');
  const nextButtonContainer = document.getElementById('next-button-container');
  const setPokemonAsBg = (div, url) => {
    div.style.backgroundColor = '';
    div.style.backgroundImage = `url(${url})`;
    div.style.backgroundRepeat = 'no-repeat';
    div.style.backgroundSize = 'contain';
    div.style.backgroundPosition = 'center center';
  }
  // This is where you'll integrate with your backend to get the Pokémon data.
  // For this example, we'll use placeholder data.
  async function loadNewRound() {
    const res = await fetch('/api');
    const json = await res.json();

    // Reset state for the new round
    gameLocked = false;
    feedbackEl.textContent = '';
    feedbackEl.classList.add('opacity-0');
    nextButtonContainer.style.display = 'none';


    const mainPokemon = document.getElementById('main-pokemon').querySelector('.pokemon-card-img');
    setPokemonAsBg(mainPokemon, json.pokemon.img);

    const options = optionsContainer.getElementsByClassName('pokemon-card');

    for (let i = 0; i < options.length; i++) {
      // Reset styles on options
      options[i].classList.remove('correct', 'wrong', 'pointer-events-none');
      const img = options[i].querySelector('.pokemon-card-img');
      setPokemonAsBg(img, json.options[i].img);
      if (json.options[i].correct) {
        options[i].setAttribute('data-correct', '');
      } else {
        options[i].removeAttribute('data-correct');
      }
    }
  }

  function checkAnswer(selectedOption) {
    if (gameLocked) return;
    gameLocked = true;

    const isCorrect = selectedOption.hasAttribute('data-correct');

    if (isCorrect) {
      // Correct answer
      score += 100;
      scoreEl.textContent = score;
      feedbackEl.textContent = "Correct!";
      feedbackEl.style.color = '#10B981'; // Green color for text
      selectedOption.classList.add('correct');
    } else {
      score -= 250;
      scoreEl.textContent = score;
      // Wrong answer
      feedbackEl.textContent = "Wrong!";
      feedbackEl.style.color = '#EF4444'; // Red color for text
      selectedOption.classList.add('wrong');

      // Highlight the correct answer
      const correctOption = optionsContainer.querySelector('[onclick*="true"]');
      if (correctOption) {
        setTimeout(() => {
          correctOption.classList.add('correct');
        }, 500);
      }
    }

    feedbackEl.classList.remove('opacity-0');

    // Disable further clicks
    const options = optionsContainer.getElementsByClassName('pokemon-card');
    for(let option of options) {
      option.classList.add('pointer-events-none');
    }

    // Show next button
    nextButtonContainer.style.display = 'block';

  }

  function nextRound() {
    // This function will set up the next question.
    // For now, it just resets the state. In a real app, you'd fetch new data here.
    loadNewRound();
  }

  // Initial load
  window.onload = () => {
    loadNewRound();
  };
</script>
</body>
</html>
